<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Camera Effects</title>

<style>
    body {
        margin: 0;
        overflow: hidden;
        background: #000;
        font-family: Arial, sans-serif;
    }

    video {
        position: absolute;
        width: 100vw;
        height: 100vh;
        object-fit: cover;
        transition: transform 0.8s ease;
    }

    #smileText {
        position: absolute;
        bottom: 40px;
        width: 100%;
        text-align: center;
        font-size: 24px;
        color: white;
        opacity: 0;
        transition: opacity 0.8s ease;
        text-shadow: 0 0 10px black;
        pointer-events: none;
    }
</style>
</head>

<body>
    <video id="camera" autoplay muted playsinline></video>

    <!-- Text xuất hiện khi cười -->
    <div id="smileText">Look at that smile… it used to warm my heart, and I truly hope you keep it with you always</div>

<script>
    const camera = document.getElementById("camera");
    const smileText = document.getElementById("smileText");

    // Mở camera
    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => camera.srcObject = stream);

    // Fake detection object (bạn sẽ gắn vào AI real)
    let isSmiling = false;

    // Hàm kích hoạt khi CƯỜI
    function onSmile() {
        if (isSmiling) return; 
        isSmiling = true;

        camera.style.transform = "scale(1.6)";
        smileText.style.opacity = 1;
    }

    // Hàm kích hoạt khi KHÔNG CƯỜI
    function onSmileEnd() {
        if (!isSmiling) return;
        isSmiling = false;

        camera.style.transform = "scale(1)";
        smileText.style.opacity = 0;
    }

    // ------------------------------
    // GIỮ NGUYÊN TOÀN BỘ HIỆU ỨNG CŨ
    // ------------------------------

    let touchStartX = 0;

    document.addEventListener("touchstart", e => {
        touchStartX = e.touches[0].clientX;
    });

    document.addEventListener("touchend", e => {
        let dx = e.changedTouches[0].clientX - touchStartX;
        if (dx > 50) {
            console.log("Vuốt phải – ảnh kế");
        } else if (dx < -50) {
            console.log("Vuốt trái – ảnh trước");
        }
    });

    // Nắm tay → cây
    function onHandClosed() {
        console.log("Nắm tay → hiện cây");
    }

    // Mở tay → explode
    function onHandOpen() {
        console.log("Mở tay → explode");
    }

    // ❤️ → i love you
    function onHeartGesture() {
        console.log("Heart → I love you");
    }

    // -------------------------------------
    // DEMO kiểm tra cười (bạn gắn AI vào đây)
    // -------------------------------------
    setInterval(() => {
        // Giả lập: random 50% cười
        const smile = Math.random() > 0.5;

        if (smile) onSmile();
        else onSmileEnd();
    }, 1200);

</script>
</body>
</html>